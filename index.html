<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KuCoin Login</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <!-- Font Awesome CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Custom checkbox styles */
      .checkbox-container {
        display: flex;
        align-items: center;
        margin: 20px 0;
        cursor: pointer;
      }

      .custom-checkbox {
        position: relative;
        width: 20px;
        height: 20px;
        margin-right: 10px;
        border-radius: 50%;
        border: 2px solid #1d1d1d;
        background-color: transparent;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: all 0.2s ease;
      }

      .custom-checkbox.checked {
        background-color: #1d1d1d;
      }

      .checkmark {
        color: white;
        font-size: 12px;
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      .custom-checkbox.checked .checkmark {
        opacity: 1;
      }

      .checkbox-label {
        font-size: 14px;
        color: #333;
      }

      /* Hide the actual checkbox */
      .hidden-checkbox {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
      }

      /* Remove the old round-checkbox styles if they exist */
      .round-checkbox {
        display: none;
      }
      
      /* Validation styles */
      .error-message {
        color: #ff3b30;
        font-size: 12px;
        margin-top: 3px;
        display: none;
        margin-bottom: 10px;
      }
      
      .custom-fieldset.error {
        border-color: #ff3b30;
      }
      
      .custom-fieldset.error legend {
        color: #ff3b30;
      }

      /* Countdown timer styles */
      .countdown-timer {
        text-align: center;
        margin-top: 10px;
        font-size: 14px;
        color: #666;
      }

      .resend-button {
        display: none;
        background-color: transparent;
        border: none;
        color: #00c087;
        cursor: pointer;
        font-size: 14px;
        margin-top: 5px;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div>
      <header id="header" >
       <div class="">
         <div class="logo">
          <img src="./images/logo-k.svg" alt="logo">
        </div>
        <!-- <div class="header-icons">
          <div class="icon">
            <i class="fa-solid fa-globe" style="color: #1a1a1a"></i>
          </div>
          <div class="icon">
            <i class="fa-solid fa-earth-americas" style="color: #1a1a1a"></i>
          </div>
          <div class="icon">
            <i class="fa-solid fa-sun" style="color: #1a1a1a"></i>
          </div>
        </div> -->
       </div>
      </header>

      <main>
        <div class="left-section">
          <div class="illustration">
            <img
              src="./images/loginpicss.png"
              alt="KuCoin Illustration"
              class="illustration-img"
            />
          </div>
          <div class="left-content">
            <p class="subtitle">Find the Next Crypto Gem on KuCoin</p>
            <div class="green-line"></div>
            <h1 class="title">
              1 Out of 4 Crypto Holders Worldwide Is with KuCoin
            </h1>
          </div>
        </div>

        <div class="right-section">
          <h2 id="loginTitle" class="login-title">Log In</h2>

          <div id="tab" class="tabs">
            <div class="tab active" data-tab="email">Email/Phone Number</div>
            <div class="tab" data-tab="subaccount">Sub-Account</div>
            <div class="tab qr-code" data-tab="qrcode">QR Code</div>
            <div class="tab-indicator"></div>
          </div>

          <form id="loginForm">
            <!-- Email/Phone Number Tab Content -->
            <div class="form-step" id="step1">
              <fieldset class="custom-fieldset" id="emailFieldset">
                <legend id="lText">Email/Phone Number</legend>
                <div class="custom-input-container">
                  <input
                    type="text"
                    id="email"
                    placeholder="Email/Phone Number"
                    required
                  />
                  <!-- <div class="input-icon">
                    <i class="fa-solid fa-envelope" style="color: #00c087"></i>
                  </div> -->
                  <div class="clear-icon" style="display: none">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>
              <div id="emailError" class="error-message">Please enter a valid email address or phone number.</div>

              <button type="button" id="nextBtn" class="btn-primary">
                Next
              </button>
            </div>

            <div class="form-step hidden" id="step2">
              <!-- Email/Phone Number Field -->
              <fieldset class="custom-fieldset">
                <legend id="lText2">Email/Phone Number</legend>
                <div class="custom-input-container">
                  <input type="text" id="email2" disabled />
                  <!-- <div class="input-icon">
                    <i class="fa-solid fa-envelope" style="color: #00c087"></i>
                  </div> -->
                  <div class="clear-icon">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>

              <!-- Password Field -->
              <fieldset class="custom-fieldset" id="passwordFieldset">
                <legend>Login Password</legend>
                <div class="custom-input-container">
                  <input
                    type="password"
                    id="password"
                    placeholder="Password"
                    required
                  />
                  <div class="toggle-password">
                    <i class="fa-solid fa-eye" style="color: #666666"></i>
                  </div>
                  <div class="clear-icon" style="display: none">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>
              <div id="passwordError" class="error-message">This field is required.</div>

              <div class="forgot-password">
                <a href="#">Forgot password?</a>
              </div>
              <button id="handleLogin" type="button" class="btn-primary">
                Log In
              </button>
            </div>

            <!-- Sub-Account Tab Content -->
            <div class="form-step hidden" id="subStep1">
              <fieldset class="custom-fieldset" id="subEmailFieldset">
                <legend>Sub Account</legend>
                <div class="custom-input-container">
                  <input
                    type="text"
                    id="subEmail"
                    placeholder="Email/Phone Number"
                    required
                  />
                  <!-- <div class="input-icon">
                    <i class="fa-solid fa-envelope" style="color: #00c087"></i>
                  </div> -->
                  <div class="clear-icon" style="display: none">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>
              <div id="subEmailError" class="error-message">Please enter a valid email address or phone number.</div>

              <button type="button" id="subNextBtn" class="btn-primary">
                Next
              </button>
            </div>

            <div class="form-step hidden" id="subStep2">
              <!-- Email/Phone Number Field -->
              <fieldset class="custom-fieldset">
                <legend>Email/Phone Number</legend>
                <div class="custom-input-container">
                  <input type="text" id="subEmail2" disabled />
                  <!-- <div class="input-icon">
                    <i class="fa-solid fa-envelope" style="color: #00c087"></i>
                  </div> -->
                  <div class="clear-icon">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>

              <!-- Password Field -->
              <fieldset class="custom-fieldset" id="subPasswordFieldset">
                <legend>Login Password</legend>
                <div class="custom-input-container">
                  <input
                    type="password"
                    id="subPassword"
                    placeholder="Password"
                    required
                  />
                  <div class="toggle-password sub-toggle-password">
                    <i class="fa-solid fa-eye" style="color: #666666"></i>
                  </div>
                  <div class="clear-icon" style="display: none">
                    <i
                      class="fa-solid fa-times-circle"
                      style="color: #666666"
                    ></i>
                  </div>
                </div>
              </fieldset>
              <div id="subPasswordError" class="error-message">This field is required.</div>

              <div class="forgot-password">
                <a href="#">Forgot password?</a>
              </div>
              <button type="button" id="subLoginBtn" class="btn-primary">
                Log In
              </button>
            </div>

            <!-- QR Code Tab Content -->
            <div class="form-step hidden" id="qrStep">
              <div class="qr-container">
                <!-- QR Code Box (contains either spinner or QR code) -->
                <div class="qr-code-box">
                  <!-- Loading spinner (shown initially) -->
                  <div id="qrLoading" class="spinner"></div>

                  <!-- QR Code (hidden initially) -->
                  <img
                    id="qrCodeImage"
                    src="./images/qrcode.png"
                    alt="KuCoin QR Code"
                    class="qr-code-img hidden"
                  />
                </div>

                <div class="qr-instruction">
                 <img class="scaner-imge" src="./images/scanner.png" alt="scaner iamge">
                  <span
                    >Open the KuCoin app and scan the QR code to log in.</span
                  >
                </div>

                <div class="qr-signup">
                  <p>Don't have an account? <a href="#">Sign up now</a></p>
                </div>
              </div>
            </div>
          </form>

          <div id="dividers" class="divider">
            <span>Or continue with</span>
          </div>

          <div id="altLogin" class="alternative-login">
            <button class="alt-login-btn passkey">
              <i class="fa-solid fa-user" style="color: #1a1a1a"></i>
              Log In with Passkey
            </button>
          </div>

          <div id="socialLogin" class="social-login">
            <button class="social-btn telegram">
             <img src="./images/skype.svg" alt="">
              Telegram
            </button>
            <button class="social-btn google">
              <img src="./images/google.png" alt="">
              Google
            </button>
            <button class="social-btn apple">
            <img src="./images/apple.svg" alt="">
              Apple
            </button>
          </div>

          <div id="signupLink" class="signup-link">
            <p>Don't have an account? <a href="#">Sign up now</a></p>
          </div>

          <div id="toast" class="toast hidden">Verification code sent</div>
        </div>
      </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Tab functionality
        const tabs = document.querySelectorAll(".tab");
        const tabIndicator = document.querySelector(".tab-indicator");

        // Get all form steps
        const step1 = document.getElementById("step1");
        const step2 = document.getElementById("step2");
        const subStep1 = document.getElementById("subStep1");
        const subStep2 = document.getElementById("subStep2");
        const qrStep = document.getElementById("qrStep");

        // Get QR code elements
        const qrLoading = document.getElementById("qrLoading");
        const qrCodeImage = document.getElementById("qrCodeImage");

        // Get all form elements
        const emailInput = document.getElementById("email");
        const email2Input = document.getElementById("email2");
        const passwordInput = document.getElementById("password");
        const subEmailInput = document.getElementById("subEmail");
        const subEmail2Input = document.getElementById("subEmail2");
        const subPasswordInput = document.getElementById("subPassword");

        // Get error message elements
        const emailError = document.getElementById("emailError");
        const passwordError = document.getElementById("passwordError");
        const subEmailError = document.getElementById("subEmailError");
        const subPasswordError = document.getElementById("subPasswordError");
        
        // Get fieldsets for styling
        const emailFieldset = document.getElementById("emailFieldset");
        const passwordFieldset = document.getElementById("passwordFieldset");
        const subEmailFieldset = document.getElementById("subEmailFieldset");
        const subPasswordFieldset = document.getElementById("subPasswordFieldset");

        // Get UI elements
        const header = document.getElementById("header");
        const tab = document.getElementById("tab");
        const loginTitle = document.getElementById("loginTitle");
        const divider = document.getElementById("dividers");
        const altLogin = document.getElementById("altLogin");
        const socialLogin = document.getElementById("socialLogin");
        const signupLink = document.getElementById("signupLink");

        // Function to hide all form steps
        function hideAllSteps() {
          const allSteps = [
            step1,
            step2,
            subStep1,
            subStep2,
            qrStep,
          ];
          allSteps.forEach((step) => {
            if (step) step.classList.add("hidden");
          });
        }

        // Function to simulate QR code loading
        function loadQRCode() {
          // Show loading spinner, hide QR code
          qrLoading.classList.remove("hidden");
          qrCodeImage.classList.add("hidden");

          // Simulate loading delay for exactly 3 seconds
          setTimeout(() => {
            // Hide loading spinner and show QR code
            qrLoading.classList.add("hidden");
            qrCodeImage.classList.remove("hidden");
          }, 3000); // 3 seconds loading time
        }

        // Function to mask email address for privacy
        function maskEmail(email) {
          if (!email) return "";
          
          // Check if it's an email (contains @)
          if (email.includes('@')) {
            const parts = email.split('@');
            const name = parts[0];
            const domain = parts[1];
            
            // Mask username part - show first 2 chars and last char
            let maskedName = '';
            if (name.length <= 3) {
              maskedName = name.charAt(0) + '*'.repeat(name.length - 1);
            } else {
              maskedName = name.substring(0, 2) + '*'.repeat(name.length - 3) + name.charAt(name.length - 1);
            }
            
            // Mask domain part
            const domainParts = domain.split('.');
            const domainName = domainParts[0];
            const extension = domainParts.slice(1).join('.');
            
            const maskedDomain = domainName.charAt(0) + '*'.repeat(domainName.length - 1);
            
            return `${maskedName}@${maskedDomain}.${extension}`;
          } 
          // If it's a phone number
          else {
            // Assuming it's a phone number, mask middle digits
            if (email.length <= 4) {
              return '*'.repeat(email.length);
            } else {
              const visibleStart = 2;
              const visibleEnd = 2;
              const start = email.substring(0, visibleStart);
              const end = email.substring(email.length - visibleEnd);
              const masked = '*'.repeat(email.length - visibleStart - visibleEnd);
              return start + masked + end;
            }
          }
        }
        
        // Function to check if input is an email
        function isEmail(input) {
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          return emailRegex.test(input);
        }
        
        // Function to check if input is a phone number
        function isPhoneNumber(input) {
          const phoneRegex = /^\d{10,}$/;
          return phoneRegex.test(input);
        }
        
        // Function to validate email or phone format
        function validateEmailOrPhone(input) {
          return isEmail(input) || isPhoneNumber(input);
        }
        
        // Add email validation events
        emailInput.addEventListener("input", function() {
          if (this.value.trim() === "") {
            emailError.style.display = "none";
            emailFieldset.classList.remove("error");
          } else if (!validateEmailOrPhone(this.value.trim())) {
            emailError.style.display = "block";
            emailFieldset.classList.add("error");
          } else {
            emailError.style.display = "none";
            emailFieldset.classList.remove("error");
          }
        });
        
        // Add sub-email validation events
        subEmailInput.addEventListener("input", function() {
          if (this.value.trim() === "") {
            subEmailError.style.display = "none";
            subEmailFieldset.classList.remove("error");
          } else if (!validateEmailOrPhone(this.value.trim())) {
            subEmailError.style.display = "block";
            subEmailFieldset.classList.add("error");
          } else {
            subEmailError.style.display = "none";
            subEmailFieldset.classList.remove("error");
          }
        });
        
        // Add password validation events
        passwordInput.addEventListener("input", function() {
          if (this.value.trim() === "") {
            passwordError.style.display = "block";
            passwordFieldset.classList.add("error");
          } else {
            passwordError.style.display = "none";
            passwordFieldset.classList.remove("error");
          }
        });
        
        // Add sub-password validation events
        subPasswordInput.addEventListener("input", function() {
          if (this.value.trim() === "") {
            subPasswordError.style.display = "block";
            subPasswordFieldset.classList.add("error");
          } else {
            subPasswordError.style.display = "none";
            subPasswordFieldset.classList.remove("error");
          }
        });

        // Tab click handler
        tabs.forEach((tab, index) => {
          tab.addEventListener("click", () => {
            // Remove active class from all tabs
            tabs.forEach((t) => t.classList.remove("active"));

            // Add active class to clicked tab
            tab.classList.add("active");

            // Move the indicator
            tabIndicator.style.transform = `translateX(${index * 100}%)`;

            // Hide all steps first
            hideAllSteps();

            // Show the appropriate form step based on the tab
            const tabType = tab.getAttribute("data-tab");
            if (tabType === "email") {
              step1.classList.remove("hidden");
              divider.classList.remove("hidden");
              altLogin.classList.remove("hidden");
              socialLogin.classList.remove("hidden");
              signupLink.classList.remove("hidden");
            } else if (tabType === "subaccount") {
              subStep1.classList.remove("hidden");
              divider.classList.remove("hidden");
              altLogin.classList.remove("hidden");
              socialLogin.classList.remove("hidden");
              signupLink.classList.remove("hidden");
            } else if (tabType === "qrcode") {
              qrStep.classList.remove("hidden");
              loadQRCode(); // Start loading QR code with 3 second delay
              divider.classList.add("hidden");
              altLogin.classList.add("hidden");
              socialLogin.classList.add("hidden");
              signupLink.classList.add("hidden");
            }
          });
        });

        // Get all clear icons and input fields
        const allInputs = document.querySelectorAll(
          'input[type="text"], input[type="password"]'
        );

        // Function to toggle clear icon visibility
        function toggleClearIcon(input) {
          if (input) {
            const clearIcon = input.parentElement.querySelector(".clear-icon");
            if (clearIcon) {
              if (input.value.trim() !== "") {
                clearIcon.style.display = "block";
              } else {
                clearIcon.style.display = "none";
              }
            }
          }
        }

        // Add input event listeners to all inputs
        allInputs.forEach((input) => {
          const clearIcon = input.parentElement.querySelector(".clear-icon");
          if (clearIcon) {
            // Initial state
            toggleClearIcon(input);

            // Listen for input changes
            input.addEventListener("input", () => {
              toggleClearIcon(input);
            });

            // Clear input when icon is clicked
            clearIcon.addEventListener("click", () => {
              input.value = "";
              toggleClearIcon(input);
              input.focus();
            });
          }
        });

        // Email/Phone Tab Next button click handler
        nextBtn.addEventListener("click", () => {
          const emailValue = emailInput.value.trim();
          
          if (emailValue !== "" && validateEmailOrPhone(emailValue)) {
            // Copy email value to step 2
            email2Input.value = emailInput.value;

            // Hide step 1 and show step 2
            step1.classList.add("hidden");
            step2.classList.remove("hidden");

            // Update clear icon visibility
            toggleClearIcon(email2Input);
            
            // Reset any error states
            emailError.style.display = "none";
            emailFieldset.classList.remove("error");
            
            // Set autofocus on password field
            setTimeout(() => {
              passwordInput.focus();
            }, 100);
          } else {
            // Show error if email is empty or invalid
            emailError.style.display = "block";
            emailFieldset.classList.add("error");
          }
        });

        // Sub-Account Tab Next button click handler
        subNextBtn.addEventListener("click", () => {
          const subEmailValue = subEmailInput.value.trim();
          
          if (subEmailValue !== "" && validateEmailOrPhone(subEmailValue)) {
            // Copy email value to subStep2
            subEmail2Input.value = subEmailInput.value;

            // Hide subStep1 and show subStep2
            subStep1.classList.add("hidden");
            subStep2.classList.remove("hidden");

            // Update clear icon visibility
            toggleClearIcon(subEmail2Input);
            
            // Reset any error states
            subEmailError.style.display = "none";
            subEmailFieldset.classList.remove("error");
            
            // Set autofocus on password field
            setTimeout(() => {
              subPasswordInput.focus();
            }, 100);
          } else {
            // Show error if email is empty or invalid
            subEmailError.style.display = "block";
            subEmailFieldset.classList.add("error");
          }
        });

        // Sub-Account Login button click handler
        subLoginBtn.addEventListener("click", () => {
          const subEmailValue = subEmail2Input.value.trim();
          const subPasswordValue = subPasswordInput.value.trim();
          
          if (subEmailValue !== "" && subPasswordValue !== "") {
            // Store user data in localStorage for verification page
            localStorage.setItem('userEmail', subEmailValue);
            localStorage.setItem('userMaskedEmail', maskEmail(subEmailValue));
            
            // Redirect to appropriate verification page based on input type
            if (isEmail(subEmailValue)) {
              window.location.href = 'emailVerification.html?type=sub';
            } else if (isPhoneNumber(subEmailValue)) {
              window.location.href = 'phoneVerification.html?type=sub';
            }
          } else {
            // Show error if password is empty
            if (subPasswordValue === "") {
              subPasswordError.style.display = "block";
              subPasswordFieldset.classList.add("error");
            }
          }
        });

        // Clear icon click handler for email2
        const email2ClearIcon = document.querySelector("#step2 .clear-icon");
        if (email2ClearIcon) {
          email2ClearIcon.addEventListener("click", () => {
            email2Input.value = "";

            // Go back to step 1
            step2.classList.add("hidden");
            step1.classList.remove("hidden");

            // Focus on email input
            emailInput.focus();

            // Update clear icon visibility
            toggleClearIcon(emailInput);
          });
        }

        // Clear icon click handler for subEmail2
        const subEmail2ClearIcon = document.querySelector(
          "#subStep2 .clear-icon"
        );
        if (subEmail2ClearIcon) {
          subEmail2ClearIcon.addEventListener("click", () => {
            subEmail2Input.value = "";

            // Go back to subStep1
            subStep2.classList.add("hidden");
            subStep1.classList.remove("hidden");

            // Focus on subEmail input
            subEmailInput.focus();

            // Update clear icon visibility
            toggleClearIcon(subEmailInput);
          });
        }

        // Toggle password visibility for main form
        const togglePassword = document.querySelector(".toggle-password");
        if (togglePassword) {
          togglePassword.addEventListener("click", () => {
            if (passwordInput.type === "password") {
              passwordInput.type = "text";
              togglePassword.innerHTML = `<i class="fa-solid fa-eye-slash" style="color: #666666;"></i>`;
            } else {
              passwordInput.type = "password";
              togglePassword.innerHTML = `<i class="fa-solid fa-eye" style="color: #666666;"></i>`;
            }
          });
        }

        // Toggle password visibility for sub-account form
        const subTogglePassword = document.querySelector(
          ".sub-toggle-password"
        );
        if (subTogglePassword) {
          subTogglePassword.addEventListener("click", () => {
            if (subPasswordInput.type === "password") {
              subPasswordInput.type = "text";
              subTogglePassword.innerHTML = `<i class="fa-solid fa-eye-slash" style="color: #666666;"></i>`;
            } else {
              subPasswordInput.type = "password";
              subTogglePassword.innerHTML = `<i class="fa-solid fa-eye" style="color: #666666;"></i>`;
            }
          });
        }

        // Form submission for main form
        const loginForm = document.getElementById("handleLogin");

        loginForm.addEventListener("click", (e) => {
          e.preventDefault();
          
          const emailValue = email2Input.value.trim();
          const passwordValue = passwordInput.value.trim();

          // Basic validation
          if (emailValue === "") {
            return;
          }
          
          if (passwordValue === "") {
            passwordError.style.display = "block";
            passwordFieldset.classList.add("error");
            return;
          }

          // Store user data in localStorage for verification page
          localStorage.setItem('userEmail', emailValue);
          localStorage.setItem('userMaskedEmail', maskEmail(emailValue));
          
          // Redirect to appropriate verification page based on input type
          if (isEmail(emailValue)) {
            window.location.href = 'emailVerification.html';
          } else if (isPhoneNumber(emailValue)) {
            window.location.href = 'phoneVerification.html';
          }
        });
      });

      // Toast message function
      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.innerText = message;
        toast.classList.remove("hidden");
        toast.classList.add("show");

        setTimeout(() => {
          toast.classList.remove("show");
          toast.classList.add("hidden");
        }, 3000); // Hide after 3 seconds
      }
    </script>
  </body>
</html>